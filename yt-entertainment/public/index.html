<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚õµ Entertainment Feed</title>
  <style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #0f0f0f;
    color: #fff;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }
  h1 { font-size: 28px; margin-bottom: 8px; color: #fff; }
  .subtitle { color: #aaa; font-size: 14px; margin-bottom: 30px; }
  .sync-status { font-size: 12px; color: #666; margin-bottom: 10px; }
  .sync-status.synced { color: #4a4; }
  .sync-status.syncing { color: #aa4; }
  .category { margin-bottom: 40px; }
  .category h2 { font-size: 20px; margin-bottom: 16px; color: #fff; border-bottom: 1px solid #333; padding-bottom: 8px; }
  .video-card { background: #1a1a1a; border-radius: 12px; overflow: hidden; margin-bottom: 20px; transition: opacity 0.3s; }
  .video-card.watched { opacity: 0.5; }
  .video-card.watched .video-title::before { content: "‚úì "; color: #4a4; }
  .video-header { display: flex; gap: 16px; padding: 16px; cursor: pointer; }
  .video-header:hover { background: #252525; }
  .thumb-container { position: relative; flex-shrink: 0; }
  .thumb { width: 200px; height: 112px; border-radius: 8px; object-fit: cover; background: #333; }
  .new-badge { position: absolute; top: 6px; left: 6px; background: #ff0000; color: #fff; font-size: 11px; font-weight: 700; padding: 2px 6px; border-radius: 4px; }
  .unwatch-btn { background: #333; color: #aaa; border: none; padding: 4px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; margin-left: auto; }
  .unwatch-btn:hover { background: #444; color: #fff; }
  .video-card:not(.watched) .unwatch-btn { display: none; }
  .video-info { flex: 1; min-width: 0; }
  .creator-name { font-size: 12px; color: #888; margin-bottom: 4px; }
  .video-title { font-size: 16px; font-weight: 500; color: #fff; line-height: 1.4; margin-bottom: 8px; }
  .video-meta { display: flex; gap: 12px; font-size: 13px; color: #888; }
  .player-container { display: none; background: #000; }
  .player-container.active { display: block; }
  .player-container iframe { width: 100%; aspect-ratio: 16/9; border: none; }
  .controls { display: flex; gap: 12px; margin-bottom: 20px; }
  .controls button { background: #333; color: #fff; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px; }
  .controls button:hover { background: #444; }
  .updated { text-align: center; color: #555; font-size: 12px; margin-top: 40px; padding-top: 20px; border-top: 1px solid #222; }
  @media (max-width: 600px) { .video-header { flex-direction: column; } .thumb { width: 100%; height: auto; aspect-ratio: 16/9; } }
</style>
</head>
<body>
  <h1>‚õµ Entertainment Feed</h1>
  <p class="subtitle">Sailing content for leisure time ‚Ä¢ Click to play</p>
  <div id="sync-status" class="sync-status">Loading...</div>
  <div class="controls">
    <button onclick="hideWatched()">Toggle Watched</button>
    <button onclick="clearWatched()">Clear History</button>
    <button onclick="loadWatched()">Refresh</button>
  </div>
<div class="category"><h2>Sailing</h2><div class="video-card" data-video-id="HFsjRc4Y2t0" data-is-new="true" onclick="togglePlayer(this, 'HFsjRc4Y2t0')">
        <div class="video-header">
          <div class="thumb-container"><img class="thumb" src="https://i.ytimg.com/vi/HFsjRc4Y2t0/hqdefault.jpg" alt="" loading="lazy"><span class="new-badge">NEW</span></div>
          <div class="video-info">
            <div class="creator-name">Practical Sailor</div>
            <div class="video-title">This ‚ÄúBulletproof‚Äù Cruiser Has a Serious Weak Spot Caliber 40 LRC SE</div>
            <div class="video-meta"><span>1 day ago</span><span>9.8K views</span></div>
          </div>
          <button class="unwatch-btn" onclick="setUnwatched('HFsjRc4Y2t0', this.closest('.video-card'), event)">Mark Unwatched</button>
        </div>
        <div class="player-container"></div>
      </div><div class="video-card" data-video-id="jE05We9IJIA" data-is-new="true" onclick="togglePlayer(this, 'jE05We9IJIA')">
        <div class="video-header">
          <div class="thumb-container"><img class="thumb" src="https://i.ytimg.com/vi/jE05We9IJIA/hqdefault.jpg" alt="" loading="lazy"><span class="new-badge">NEW</span></div>
          <div class="video-info">
            <div class="creator-name">New Kids On The Dock</div>
            <div class="video-title">This System is CRITICAL for our 57ft Abandoned Catamaran‚Ä¶And We‚Äôve Never Done it Before üò¨</div>
            <div class="video-meta"><span>5 days ago</span><span>131K views</span></div>
          </div>
          <button class="unwatch-btn" onclick="setUnwatched('jE05We9IJIA', this.closest('.video-card'), event)">Mark Unwatched</button>
        </div>
        <div class="player-container"></div>
      </div><div class="video-card" data-video-id="XhZZCNfBmLI" data-is-new="true" onclick="togglePlayer(this, 'XhZZCNfBmLI')">
        <div class="video-header">
          <div class="thumb-container"><img class="thumb" src="https://i.ytimg.com/vi/XhZZCNfBmLI/hqdefault.jpg" alt="" loading="lazy"><span class="new-badge">NEW</span></div>
          <div class="video-info">
            <div class="creator-name">Sailing Parlay Revival</div>
            <div class="video-title">REBUILDING OUR HULLS: Blister repair series - part 4  (Episode 350)</div>
            <div class="video-meta"><span>2 days ago</span><span>136K views</span></div>
          </div>
          <button class="unwatch-btn" onclick="setUnwatched('XhZZCNfBmLI', this.closest('.video-card'), event)">Mark Unwatched</button>
        </div>
        <div class="player-container"></div>
      </div></div><div class="updated">Last updated: Feb 10, 2026, 11:29 AM PST</div><script>
  const API_URL = 'https://yt-research-wheat.vercel.app/api/watched';
  let watchedData = {};
  let syncTimeout = null;
  let watchTimers = {};
  
  async function loadWatched() {
    setStatus('syncing', 'Loading...');
    try {
      const res = await fetch(API_URL);
      const data = await res.json();
      watchedData = data.watched || {};
      localStorage.setItem('yt-watched', JSON.stringify(watchedData));
      updateWatchedUI();
      setStatus('synced', 'Synced ‚úì');
    } catch (e) {
      console.error('Load failed:', e);
      try { watchedData = JSON.parse(localStorage.getItem('yt-watched') || '{}'); updateWatchedUI(); } catch {}
      setStatus('error', 'Offline mode');
    }
  }
  
  async function saveWatched() {
    setStatus('syncing', 'Saving...');
    try {
      await fetch(API_URL, { 
        method: 'PUT', 
        headers: { 'Content-Type': 'application/json' }, 
        body: JSON.stringify({ watched: watchedData }) 
      });
      localStorage.setItem('yt-watched', JSON.stringify(watchedData));
      setStatus('synced', 'Synced ‚úì');
    } catch (e) { 
      console.error('Save failed:', e);
      setStatus('error', 'Sync failed'); 
    }
  }
  
  function debouncedSave() { clearTimeout(syncTimeout); syncTimeout = setTimeout(saveWatched, 500); }
  function setStatus(cls, text) { const el = document.getElementById('sync-status'); if (el) { el.className = 'sync-status ' + cls; el.textContent = text; } }
  function setWatched(videoId, card) { 
    watchedData[videoId] = Date.now(); 
    debouncedSave(); 
    if (card) {
      card.classList.add('watched');
      const badge = card.querySelector('.new-badge');
      if (badge) badge.style.display = 'none';
    }
  }
  function setUnwatched(videoId, card, e) {
    e.stopPropagation();
    delete watchedData[videoId];
    debouncedSave();
    if (card) {
      card.classList.remove('watched');
      if (card.dataset.isNew === 'true') {
        const badge = card.querySelector('.new-badge');
        if (badge) badge.style.display = 'block';
      }
    }
  }
  function isWatched(videoId) { return !!watchedData[videoId]; }
  function updateWatchedUI() { 
    document.querySelectorAll('.video-card').forEach(card => { 
      const vid = card.dataset.videoId;
      const watched = isWatched(vid);
      card.classList.toggle('watched', watched);
      const badge = card.querySelector('.new-badge');
      if (badge && watched) badge.style.display = 'none';
    }); 
  }
  
  function togglePlayer(card, videoId) {
    const container = card.querySelector('.player-container');
    const isActive = container.classList.contains('active');
    // Clear all other players and timers
    document.querySelectorAll('.player-container.active').forEach(p => { 
      p.classList.remove('active'); 
      p.innerHTML = ''; 
    });
    Object.keys(watchTimers).forEach(id => { clearTimeout(watchTimers[id]); delete watchTimers[id]; });
    
    if (!isActive) {
      container.innerHTML = '<iframe src="https://www.youtube.com/embed/' + videoId + '?autoplay=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>';
      container.classList.add('active');
      // Mark watched after 30 seconds
      watchTimers[videoId] = setTimeout(() => {
        if (!isWatched(videoId)) {
          setWatched(videoId, card);
        }
      }, 30000);
    }
  }
  
  async function clearWatched() { if (confirm('Clear all watched markers?')) { watchedData = {}; await saveWatched(); updateWatchedUI(); } }
  function hideWatched() { document.querySelectorAll('.video-card.watched').forEach(card => { card.style.display = card.style.display === 'none' ? 'block' : 'none'; }); }
  document.addEventListener('DOMContentLoaded', loadWatched);
</script></body></html>